utility functions for version 1 or version 2